<app-breadcrumb [titleBreadcrumbs]="breadCrumb"/>

<div class="teacher-details-container">
    
  <!-- Fixed Header -->
  <!-- <div class="details-header">
    <button class="back-btn" routerLink="/teachers">
      <span class="btn-icon">â†</span> Back to Teachers
    </button>
    <div class="header-actions">
      <button class="btn btn-secondary">
        <span class="btn-icon">ğŸ“‹</span> Print
      </button>
      <button class="btn btn-primary">
        <span class="btn-icon">âœï¸</span> Edit Teacher
      </button>
    </div>
  </div> -->

  <!-- Scrollable Content Area -->
  <div class="scrollable-content">
    <div class="details-content-wrapper">
      <!-- Teacher Profile Card -->
      <div class="profile-card">
        <div class="profile-header">
          <div class="avatar-large">
            {{teacher().name.charAt(0)}}{{teacher().surname.charAt(0)}}
          </div>
          <div class="profile-info">
            <h1 class="teacher-name">{{teacher().name}} {{teacher().surname}}</h1>
            <div class="teacher-meta">
              <span class="teacher-id">ID: {{teacher().id}}</span>
              <span class="role-badge" [class]="getRoleClass(teacher().role)">
                {{teacher().role}}
              </span>
            </div>
          </div>
        </div>

        <!-- Details Sections -->
        <div class="details-sections">
          <!-- Personal Information -->
          <!-- <section class="details-section">
            <div class="section-header">
              <h2 class="section-title">
                <span class="section-icon">ğŸ‘¤</span>
                Personal Information
              </h2>
              @if(!onEditMode()){
                <button class="btn-edit-section" (click)="toggleEditMode()">
                  <span class="edit-icon">âœï¸</span>
                  Edit
                </button>
              }
            </div>
            
            <div class="info-grid">
              <div class="info-item">
                @if(onEditMode()){
                  <div class="form-group-grid">
                    <div class="form-group">
                      <label for="teacher_name" class="form-label">First Name</label>
                      <input 
                        class="form-input" 
                        type="text" 
                        id="teacher_name" 
                        [(ngModel)]="editTeacher.name"
                        placeholder="Enter first name"
                      >
                    </div>
                    <div class="form-group">
                      <label for="teacher_surname" class="form-label">Last Name</label>
                      <input 
                        class="form-input" 
                        type="text" 
                        id="teacher_surname" 
                        [(ngModel)]="editTeacher.surname"
                        placeholder="Enter last name"
                      >
                    </div>
                  </div>
                }
                @else {
                  <span class="info-label">Full Name</span>
                  <span class="info-value">{{teacher?.name}} {{teacher?.surname}}</span>
                }
              </div>
              
              <div class="info-item">
                <span class="info-label">Date of Birth</span>
                @if(onEditMode()){
                  <input 
                    class="form-input" 
                    type="date" 
                    id="date_of_birth" 
                    [(ngModel)]="editTeacher.date_of_birth"
                    [value]="formatDateForInput(teacher?.date_of_birth)"
                  >
                }
                @else {
                  <span class="info-value">{{formatDate(teacher?.date_of_birth)}}</span>
                }
              </div>
              
              <div class="info-item">
                <span class="info-label">Age</span>
                <span class="info-value">{{calculateAge(teacher?.date_of_birth)}} years</span>
              </div>
              
              <div class="info-item">
                <span class="info-label">Date Joined</span>
                @if(onEditMode()){
                  <input 
                    class="form-input" 
                    type="date" 
                    id="date_joined" 
                    [(ngModel)]="editTeacher.date_joined"
                    [value]="formatDateForInput(teacher?.date_joined)"
                  >
                }
                @else {
                  <span class="info-value">{{formatDate(teacher?.date_joined)}}</span>
                }
              </div>
              
              @if(onEditMode()){
                <div class="form-actions">
                  <button class="btn btn-secondary" (click)="cancelEdit()">
                    Cancel
                  </button>
                  <button class="btn btn-primary" (click)="savePersonalInfo()">
                    Save Changes
                  </button>
                </div>
              }
            </div>
          </section> -->
          <app-personal-information-section [personalInformation]="teacher()"/>

          <!-- Contact Information -->
          <!-- <section class="details-section">
            <h2 class="section-title">
              <span class="section-icon">ğŸ“±</span>
              Contact Information
            </h2>
            <div class="contact-cards">
              <a [href]="'mailto:' + teacher?.email" class="contact-card email">
                <span class="contact-icon">âœ‰ï¸</span>
                <div class="contact-content">
                  <span class="contact-label">Email Address</span>
                  <span class="contact-value">{{teacher?.email}}</span>
                </div>
              </a>
              <a [href]="'tel:' + teacher?.phone" class="contact-card phone">
                <span class="contact-icon">ğŸ“</span>
                <div class="contact-content">
                  <span class="contact-label">Phone Number</span>
                  <span class="contact-value">{{teacher?.phone}}</span>
                </div>
              </a>
              <div class="contact-card address">
                <span class="contact-icon">ğŸ“</span>
                <div class="contact-content">
                  <span class="contact-label">Physical Address</span>
                  <span class="contact-value">{{teacher?.address}}</span>
                </div>
              </div>
            </div>
          </section> -->
          <app-contact-information-section/>
          

          <!-- Subjects & Expertise -->
          <!-- <section class="details-section">
            <h2 class="section-title">
              <span class="section-icon">ğŸ“š</span>
              Subjects & Expertise
            </h2>
            <div class="expertise-section">
              <div class="subjects-list">
                <h3 class="subsection-title">Expected Subjects</h3>
                <div class="chips-container">
                  @for(subject of teacher?.expect_subjects; track $index){
                    <span class="subject-chip">
                        {{subject}}
                    </span>
                  }
                </div>
              </div>
              <div class="subjects-list">
                <h3 class="subsection-title">Assigned Subjects</h3>
                <div class="chips-container">
                  <span class="subject-chip assigned" *ngFor="let subject of teacher?.assigned_subjects">
                    {{subject}}
                  </span>
                </div>
              </div>

            </div>
          </section> -->

          <!-- Assigned Classes -->
          <!-- <section class="details-section">
            <h2 class="section-title">
              <span class="section-icon">ğŸ«</span>
              Assigned Classes
            </h2>
            <div class="classes-grid">
              @for(classItem of teacher?.assigned_classes; track $index){
                <div class="class-card">
                    <span class="class-icon">ğŸ‘©â€ğŸ«</span>
                    <span class="class-name">{{classItem}}</span>
                  <div class="assigned-container">
                      <h4 class="subsection-title">Subjects</h4>
                        <div class="chips-container">
                          @for(subject of teacher?.expect_subjects; track $index){
                            <span class="subject-chip">
                                {{subject}}
                            </span>
                          }
                        </div>
                  </div>
                </div>
              }
            </div>
          </section> -->
          <!-- Class Cards Section -->
          <section class="details-section">
            <div class="section-header">
              <h2 class="section-title">
                <span class="section-icon">ğŸ«</span>
                Assigned Classes
              </h2>
              <!-- <button class="btn btn-primary btn-add" (click)="addClass()">
                <span class="btn-icon">+</span>
                Add Class
              </button> -->
            </div>
            
            <div class="classes-container">
              <!-- Add Class Card (First Card) -->
              <div class="class-card add-card" (click)="addClass()">
                <div class="add-icon-container">
                  <span class="add-icon">+</span>
                </div>
                <span class="add-label">Add New Class</span>
              </div>
              
              <!-- Existing Class Cards -->
              @for(classItem of assigned_classes(); track $index; let parentIndex = $index) {
                <div class="class-card">
                  <div class="class-card-header">
                    <span class="class-icon">ğŸ‘©â€ğŸ«</span>
                    <span class="class-name">{{classItem}}</span>
                    <button class="class-action" (click)="removeClass($index)" title="Remove Class">
                      <span class="action-icon">Ã—</span>
                    </button>
                  </div>
                  
                  <div class="assigned-container">
                    <div class="subject-header">
                      <h4 class="subsection-title">Subjects</h4>
                      <button class="btn-add-subject" (click)="addSubjectToClass($index)" title="Add Subject">
                        <span class="add-icon">+</span>
                      </button>
                    </div>
                    
                    <div class="chips-container">
                      @for(subject of assigned_subjects(); track $index) {
                        <span class="subject-chip">
                          {{subject}}
                          <button class="chip-remove" (click)="removeSubjectFromClass($index, parentIndex)" title="Remove Subject">
                            Ã—
                          </button>
                        </span>
                      }
                    </div>
                    
                    <!-- Add Subject Input (Hidden by default) -->
                     @if(showAddSubjectInput === $index){
                        <div class="add-subject-input">
                          <input 
                            type="text" 
                            class="subject-input" 
                            [(ngModel)]="newSubject"
                            placeholder="Enter subject name..."
                            (keyup.enter)="confirmAddSubject($index)"
                            #subjectInput
                            (blur)="hideAddSubjectInput()"
                          >
                          <button class="btn-confirm" (click)="confirmAddSubject($index)">âœ“</button>
                          <button class="btn-cancel" (click)="hideAddSubjectInput()">Ã—</button>
                        </div>
                     }
                    
                  </div>
                  
                  <!-- Class Stats -->
                  <div class="class-stats">
                    <div class="stat-item">
                      <span class="stat-icon">ğŸ‘¥</span>
                      <span class="stat-value">24</span>
                      <span class="stat-label">Students</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-icon">ğŸ“š</span>
                      <span class="stat-value">{{assigned_subjects().length || 0}}</span>
                      <span class="stat-label">Subjects</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-icon">â°</span>
                      <span class="stat-value">5</span>
                      <span class="stat-label">Periods/Day</span>
                    </div>
                  </div>
                </div>
              }
            </div>
          </section>

          <!-- Additional Information -->
          <section class="details-section">
            <h2 class="section-title">
              <span class="section-icon">ğŸ“Š</span>
              Additional Information
            </h2>
            <div class="stats-grid">
              <div class="stat-card">
                <span class="stat-icon">ğŸ“…</span>
                <div class="stat-content">
                  <span class="stat-value">3 Years</span>
                  <span class="stat-label">Years of Service</span>
                </div>
              </div>
              <div class="stat-card">
                <span class="stat-icon">ğŸ¯</span>
                <div class="stat-content">
                  <span class="stat-value">94%</span>
                  <span class="stat-label">Student Satisfaction</span>
                </div>
              </div>
              <div class="stat-card">
                <span class="stat-icon">ğŸ“ˆ</span>
                <div class="stat-content">
                  <span class="stat-value">A+</span>
                  <span class="stat-label">Performance Rating</span>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>
</div>